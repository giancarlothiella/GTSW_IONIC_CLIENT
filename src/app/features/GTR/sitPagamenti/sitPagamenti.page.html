<div class="pageFormat">
  <app-gts-loader></app-gts-loader>
  <p-toast></p-toast>

  <!-- Hidden file input for Excel upload -->
  <input
    type="file"
    #excelFileInput
    accept=".xlsx,.xls"
    style="display: none"
    (change)="onExcelFileSelected($event)">

  <app-gts-toolbar
    [prjId]="prjId"
    [formId]="formId"
    [objectName]="'mainToolbar'"
    [customData]="customData"
    (newValueEvent)="gtsDataService.toolbarSelectEvent($event)"
  ></app-gts-toolbar>

  <div
    [style]="viewStyle"
    >
    @for (element of metaData.tabs; track element.objectName) {
      @if (element.visible) {
        <app-gts-tabs
          [style]="'grid-area: '+element.gridArea"
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
        ></app-gts-tabs>
      }
    }

    @for (element of metaData.toolbars; track element.objectName) {
      @if (element.visible && element.objectName != 'mainToolbar' && !element.toolbarFlagSubmit) {
        <app-gts-toolbar
          [style]="'grid-area: '+element.gridArea"
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
          [customCssClass]="element.customCssClass"
          (newValueEvent)="gtsDataService.toolbarSelectEvent($event)"
        ></app-gts-toolbar>
      }
    }

    @for (element of metaData.grids; track element.objectName) {
      @if (element.visible) {
        <app-gts-grid
          [style]="'grid-area: '+element.gridArea"
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
        ></app-gts-grid>
      }
    }

    @for (element of metaData.forms; track element.objectName) {
      @if (element.visible && !element.groupShowPopUp) {
        <app-gts-form
          [style]="'grid-area: '+element.gridArea"
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
        ></app-gts-form>
      }
      @if (element.visible && element.groupShowPopUp) {
        <app-gts-form-popup
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
        ></app-gts-form-popup>
      }
    }
  </div>

  <app-gts-message
    [prjId]="prjId"
    [formId]="formId"
  ></app-gts-message>

  <!-- AI Analyzer Component -->
  <app-gts-ai-analyzer
    [data]="aiAnalyzerData"
    [config]="aiAnalyzerConfig"
    [(visible)]="showAiAnalyzer">
  </app-gts-ai-analyzer>
</div>
