<div class="pageFormat">
  <app-gts-toolbar
    [prjId]="prjId"
    [formId]="formId"
    [objectName]="'mainToolbar'"
    [customData]="customData"
    (newValueEvent)="gtsDataService.toolbarSelectEvent($event)"
  ></app-gts-toolbar>

  @if (loading) {
    <app-gts-loader></app-gts-loader>
  }  

  <div
    [style]="viewStyle"
    >
    @for (element of metaData.tabs; track element.objectName) {
      @if (element.visible) {
        <app-gts-tabs
          [style]="'grid-area: '+element.gridArea"
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
        ></app-gts-tabs>
      }
    }

    @for (element of metaData.toolbars; track element.objectName) {
      @if (element.visible && element.objectName != 'mainToolbar' && !element.toolbarFlagSubmit) {
        <app-gts-toolbar
          [style]="'grid-area: '+element.gridArea"
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
          [customCssClass]="element.customCssClass"
          (newValueEvent)="gtsDataService.toolbarSelectEvent($event)"
        ></app-gts-toolbar>
      }
    }

    @for (element of metaData.grids; track element.objectName) {
      @if (element.visible) {
        <app-gts-grid
          [style]="'grid-area: '+element.gridArea"
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
        ></app-gts-grid>
      }
    }

    @for (element of metaData.forms; track element.objectName) {
      @if (element.visible && !element.groupShowPopUp) {
        <app-gts-form
          [style]="'grid-area: '+element.gridArea"
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
        ></app-gts-form>
      }
      @if (element.visible && element.groupShowPopUp) {
        <app-gts-form-popup
          [prjId]="prjId"
          [formId]="formId"
          [objectName]="element.objectName"
        ></app-gts-form-popup>
      }
    }
  </div>

  <app-gts-message
    [prjId]="prjId"
    [formId]="formId"
  ></app-gts-message>
</div>

<!-- Dialog per Session ID -->
<p-dialog
  [header]="t(700, 'Carica Template')"
  [(visible)]="showSessionIdDialog"
  [modal]="true"
  [style]="{ width: '400px' }"
  [closable]="true"
  (onHide)="cancelLoadTemplate()"
>
  <div class="flex flex-column gap-3">
    <p class="m-0 text-sm text-color-secondary">
      {{ t(701, 'Inserisci un Session ID per caricare i dati reali come mock data. Lascia vuoto per usare i mock data esistenti nel template.') }}
    </p>

    <div class="flex flex-column gap-2">
      <label for="sessionId" class="font-medium">{{ t(702, 'Session ID (opzionale)') }}</label>
      <p-inputNumber
        id="sessionId"
        [(ngModel)]="sessionIdInput"
        [useGrouping]="false"
        placeholder="Es. 12345"
        [style]="{ width: '100%' }"
      ></p-inputNumber>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <div class="flex justify-content-end gap-2">
      <p-button
        [label]="t(703, 'Annulla')"
        severity="secondary"
        (onClick)="cancelLoadTemplate()"
      ></p-button>
      <p-button
        [label]="t(704, 'Carica')"
        (onClick)="confirmLoadTemplate()"
      ></p-button>
    </div>
  </ng-template>
</p-dialog>
