{
  "prjId": "DCW",
  "connCode": "DCW_SS",
  "dashboardCode": "salesDashboard",
  "title": "Sales Dashboard",
  "description": "Dashboard vendite con KPI, trend e analisi",

  "datasets": [
    {
      "datasetId": "sales",
      "adapterCode": "daDummy",
      "dataSetCode": "qSales",
      "description": "Dataset principale vendite",
      "cacheKey": "salesDashboard_51",
      "cacheTTL": 30
    }
  ],

  "filters": [
    {
      "field": "anno",
      "datasetId": "sales",
      "type": "select",
      "label": "Anno",
      "options": "auto",
      "defaultValue": "all",
      "placeholder": "Seleziona anno"
    },
    {
      "field": "trimestre",
      "datasetId": "sales",
      "type": "select",
      "label": "Trimestre",
      "options": [
        { "label": "Tutti", "value": "all" },
        { "label": "Q1", "value": "Q1" },
        { "label": "Q2", "value": "Q2" },
        { "label": "Q3", "value": "Q3" },
        { "label": "Q4", "value": "Q4" }
      ],
      "defaultValue": "all",
      "dependsOn": "anno",
      "placeholder": "Seleziona trimestre"
    },
    {
      "field": "mese",
      "datasetId": "sales",
      "type": "select",
      "label": "Mese",
      "options": [
        { "label": "Tutti", "value": "all" },
        { "label": "Gennaio", "value": "01" },
        { "label": "Febbraio", "value": "02" },
        { "label": "Marzo", "value": "03" },
        { "label": "Aprile", "value": "04" },
        { "label": "Maggio", "value": "05" },
        { "label": "Giugno", "value": "06" },
        { "label": "Luglio", "value": "07" },
        { "label": "Agosto", "value": "08" },
        { "label": "Settembre", "value": "09" },
        { "label": "Ottobre", "value": "10" },
        { "label": "Novembre", "value": "11" },
        { "label": "Dicembre", "value": "12" }
      ],
      "defaultValue": "all",
      "dependsOn": "anno",
      "placeholder": "Seleziona mese"
    }
  ],

  "settings": {
    "locale": "it-IT",
    "currency": "EUR",
    "dateFormat": "dd/MM/yyyy",
    "numberFormat": {
      "minimumFractionDigits": 0,
      "maximumFractionDigits": 2
    }
  },

  "layout": {
    "gap": 16,
    "baseRowHeight": 100,
    "sections": [
      {
        "sectionId": "kpi-cards",
        "columns": 8,
        "rowHeight": 1.2,
        "minItemWidth": 200,
        "maxItemWidth": 280,
        "items": ["totalRevenue", "totalMargin", "totalQty", "numOrders", "numCustomers", "numProducts", "totalCosts", "avgPriceKg"]
      },
      {
        "sectionId": "trends",
        "columns": 5,
        "rowHeight": 4,
        "items": ["revenueTrend", "marginTrend"]
      },
      {
        "sectionId": "rankings-bar",
        "columns": 2,
        "rowHeight": 4,
        "items": ["topCustomers", "topProducts"]
      },
      {
        "sectionId": "rankings-pie",
        "columns": 2,
        "rowHeight": 4,
        "items": ["revenueByCategory", "topProductFamilies"]
      },
      {
        "sectionId": "detail-grids",
        "columns": 2,
        "rowHeight": 6,
        "items": ["customerDetail", "productDetail"]
      }
    ]
  },

  "items": [
    {
      "itemId": "totalRevenue",
      "type": "card",
      "position": { "order": 0, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "totale" }
        ]
      },
      "cardConfig": {
        "icon": "pi pi-dollar",
        "accentColor": "#4CAF50",
        "valueField": "totale",
        "format": "currency",
        "decimals": 0,
        "label": "TOTAL REVENUE"
      },
      "title": "Fatturato Totale",
      "visible": true
    },

    {
      "itemId": "totalMargin",
      "type": "card",
      "position": { "order": 1, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "aggregations": [
          { "field": "delta", "operation": "sum", "alias": "margine" },
          { "field": "valore", "operation": "sum", "alias": "fatturato" }
        ]
      },
      "cardConfig": {
        "icon": "pi pi-chart-bar",
        "accentColor": "#2196F3",
        "valueField": "margine",
        "format": "currency",
        "decimals": 0,
        "label": "TOTAL MARGIN"
      },
      "title": "Margine Totale",
      "visible": true
    },

    {
      "itemId": "totalQty",
      "type": "card",
      "position": { "order": 2, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "aggregations": [
          { "field": "kg", "operation": "sum", "alias": "totaleKg" }
        ]
      },
      "cardConfig": {
        "icon": "pi pi-box",
        "accentColor": "#FF9800",
        "valueField": "totaleKg",
        "format": "number",
        "decimals": 0,
        "label": "TOTAL QUANTITY (KG)"
      },
      "title": "Quantita Totale",
      "visible": true
    },

    {
      "itemId": "numOrders",
      "type": "card",
      "position": { "order": 3, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "aggregations": [
          { "field": "num doc", "operation": "countDistinct", "alias": "numOrdini" }
        ]
      },
      "cardConfig": {
        "icon": "pi pi-file",
        "accentColor": "#9C27B0",
        "valueField": "numOrdini",
        "format": "integer",
        "label": "ORDERS"
      },
      "title": "Numero Ordini",
      "visible": true
    },

    {
      "itemId": "numCustomers",
      "type": "card",
      "position": { "order": 4, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "aggregations": [
          { "field": "clienti", "operation": "countDistinct", "alias": "numClienti" }
        ]
      },
      "cardConfig": {
        "icon": "pi pi-users",
        "accentColor": "#00BCD4",
        "valueField": "numClienti",
        "format": "integer",
        "label": "CUSTOMERS"
      },
      "title": "Numero Clienti",
      "visible": true
    },

    {
      "itemId": "numProducts",
      "type": "card",
      "position": { "order": 5, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "aggregations": [
          { "field": "prodotto", "operation": "countDistinct", "alias": "numProdotti" }
        ]
      },
      "cardConfig": {
        "icon": "pi pi-tag",
        "accentColor": "#795548",
        "valueField": "numProdotti",
        "format": "integer",
        "label": "PRODUCTS"
      },
      "title": "Numero Prodotti",
      "visible": true
    },

    {
      "itemId": "totalCosts",
      "type": "card",
      "position": { "order": 6, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "aggregations": [
          { "field": "totale costi", "operation": "sum", "alias": "totaleCosti" }
        ]
      },
      "cardConfig": {
        "icon": "pi pi-wallet",
        "accentColor": "#8BC34A",
        "valueField": "totaleCosti",
        "format": "currency",
        "decimals": 0,
        "label": "TOTAL COSTS"
      },
      "title": "Costi Totali",
      "visible": true
    },

    {
      "itemId": "avgPriceKg",
      "type": "card",
      "position": { "order": 7, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "totaleValore" },
          { "field": "kg", "operation": "sum", "alias": "totaleKg" }
        ]
      },
      "cardConfig": {
        "icon": "pi pi-sliders-h",
        "accentColor": "#FFC107",
        "valueField": "avgPriceKg",
        "format": "currency",
        "decimals": 2,
        "label": "AVG PRICE/KG"
      },
      "title": "Prezzo Medio/Kg",
      "visible": true
    },

    {
      "itemId": "revenueTrend",
      "type": "chart",
      "position": { "order": 0, "colSpan": 3 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": "periodo",
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["anno", "mese"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" },
          { "field": "delta", "operation": "sum", "alias": "margine" }
        ],
        "sortBy": { "field": "periodo", "order": "asc" }
      },
      "chartConfig": {
        "chartType": "line",
        "xAxis": { "field": "periodo", "label": "Periodo" },
        "yAxis": { "label": "Euro" },
        "series": [
          { "field": "fatturato", "label": "Fatturato", "color": "#2196F3" },
          { "field": "margine", "label": "Margine", "color": "#4CAF50" }
        ],
        "showLegend": true,
        "legendPosition": "top",
        "showGrid": true,
        "height": 300
      },
      "title": "Revenue and Margin Trend",
      "visible": true
    },

    {
      "itemId": "marginTrend",
      "type": "chart",
      "position": { "order": 1, "colSpan": 2 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["anno", "mese"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" },
          { "field": "delta", "operation": "sum", "alias": "margine" }
        ],
        "sortBy": { "field": "periodo", "order": "asc" }
      },
      "chartConfig": {
        "chartType": "bar",
        "xAxis": { "field": "periodo" },
        "yAxis": { "label": "%" },
        "series": [
          { "field": "marginePct", "label": "Margine %", "color": "#FF9800" }
        ],
        "showLegend": true,
        "height": 300
      },
      "title": "Margin % Trend",
      "visible": true
    },

    {
      "itemId": "topCustomers",
      "type": "chart",
      "position": { "order": 0, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": "clienti",
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["clienti"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" }
        ],
        "sortBy": { "field": "fatturato", "order": "desc" },
        "limit": 10
      },
      "chartConfig": {
        "chartType": "horizontalBar",
        "xAxis": { "field": "clienti" },
        "series": [
          { "field": "fatturato", "label": "Fatturato", "color": "#2196F3" }
        ],
        "showLegend": false,
        "height": 280
      },
      "title": "Top 10 Customers",
      "subtitle": "Click for details",
      "visible": true
    },

    {
      "itemId": "topProducts",
      "type": "chart",
      "position": { "order": 1, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": "prodotto",
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["prodotto"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" }
        ],
        "sortBy": { "field": "fatturato", "order": "desc" },
        "limit": 10
      },
      "chartConfig": {
        "chartType": "horizontalBar",
        "xAxis": { "field": "prodotto" },
        "series": [
          { "field": "fatturato", "label": "Fatturato", "color": "#4CAF50" }
        ],
        "showLegend": false,
        "height": 280
      },
      "title": "Top 10 Products",
      "subtitle": "Click for details",
      "visible": true
    },

    {
      "itemId": "revenueByCategory",
      "type": "chart",
      "position": { "order": 2, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": "categoria",
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["categoria"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" }
        ],
        "sortBy": { "field": "fatturato", "order": "desc" }
      },
      "chartConfig": {
        "chartType": "pie",
        "labelField": "categoria",
        "valueField": "fatturato",
        "showLegend": true,
        "legendPosition": "right",
        "height": 280,
        "colors": ["#2196F3", "#4CAF50", "#FF9800", "#E91E63", "#9C27B0", "#00BCD4", "#795548", "#607D8B", "#3F51B5", "#009688", "#FFC107", "#8BC34A"]
      },
      "title": "Revenue by Category",
      "subtitle": "Click for details",
      "visible": true
    },

    {
      "itemId": "topProductFamilies",
      "type": "chart",
      "position": { "order": 3, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": "famiglia",
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["famiglia"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" }
        ],
        "sortBy": { "field": "fatturato", "order": "desc" },
        "limit": 10
      },
      "chartConfig": {
        "chartType": "doughnut",
        "labelField": "famiglia",
        "valueField": "fatturato",
        "showLegend": true,
        "legendPosition": "right",
        "height": 280,
        "colors": ["#E91E63", "#9C27B0", "#2196F3", "#00BCD4", "#4CAF50", "#8BC34A", "#FF9800", "#FF5722", "#795548", "#607D8B", "#3F51B5", "#FFC107"]
      },
      "title": "Top Product Families",
      "subtitle": "Click for details",
      "visible": true
    },

    {
      "itemId": "customerDetail",
      "type": "grid",
      "position": { "order": 0, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": "prodotto",
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["prodotto"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" },
          { "field": "kg", "operation": "sum", "alias": "quantita" },
          { "field": "delta", "operation": "sum", "alias": "margine" }
        ],
        "sortBy": { "field": "fatturato", "order": "desc" },
        "limit": 20
      },
      "gridConfig": {
        "columns": [
          { "field": "prodotto", "header": "Prodotto", "width": "250px", "format": "text" },
          { "field": "fatturato", "header": "Fatturato", "width": "150px", "format": "currency", "align": "right" },
          { "field": "quantita", "header": "Quantita", "width": "120px", "format": "number", "decimals": 0, "align": "right" },
          { "field": "margine", "header": "Margine", "width": "150px", "format": "currency", "align": "right" }
        ],
        "showTotals": true,
        "totalsFields": ["fatturato", "quantita", "margine"],
        "pageSize": 10,
        "showPagination": true,
        "rowClickable": true
      },
      "title": "Products by Revenue",
      "subtitle": "Click for customer breakdown",
      "visible": true
    },

    {
      "itemId": "productDetail",
      "type": "grid",
      "position": { "order": 1, "colSpan": 1 },
      "level": 0,
      "parentItemId": null,
      "drillDownFilter": "clienti",
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["clienti"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" },
          { "field": "kg", "operation": "sum", "alias": "quantita" },
          { "field": "delta", "operation": "sum", "alias": "margine" }
        ],
        "sortBy": { "field": "fatturato", "order": "desc" },
        "limit": 20
      },
      "gridConfig": {
        "columns": [
          { "field": "clienti", "header": "Cliente", "width": "250px", "format": "text" },
          { "field": "fatturato", "header": "Fatturato", "width": "150px", "format": "currency", "align": "right" },
          { "field": "quantita", "header": "Quantita", "width": "120px", "format": "number", "decimals": 0, "align": "right" },
          { "field": "margine", "header": "Margine", "width": "150px", "format": "currency", "align": "right" }
        ],
        "showTotals": true,
        "totalsFields": ["fatturato", "quantita", "margine"],
        "pageSize": 10,
        "showPagination": true,
        "rowClickable": true
      },
      "title": "Customers by Revenue",
      "subtitle": "Click for product breakdown",
      "visible": true
    },

    {
      "itemId": "productCustomerBreakdown",
      "type": "chart",
      "position": { "order": 0, "colSpan": 1 },
      "level": 1,
      "parentItemId": "customerDetail",
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["clienti"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" }
        ],
        "sortBy": { "field": "fatturato", "order": "desc" },
        "limit": 10
      },
      "chartConfig": {
        "chartType": "pie",
        "labelField": "clienti",
        "valueField": "fatturato",
        "showLegend": true,
        "legendPosition": "right",
        "height": 300,
        "colors": ["#2196F3", "#4CAF50", "#FF9800", "#E91E63", "#9C27B0", "#00BCD4", "#795548", "#607D8B", "#3F51B5", "#009688"]
      },
      "title": "Customers for Product",
      "visible": true
    },

    {
      "itemId": "customerProductBreakdown",
      "type": "chart",
      "position": { "order": 1, "colSpan": 1 },
      "level": 1,
      "parentItemId": "productDetail",
      "drillDownFilter": null,
      "dataSource": { "type": "dataAdapter" },
      "datasetId": "sales",
      "aggregationRule": {
        "groupBy": ["prodotto"],
        "aggregations": [
          { "field": "valore", "operation": "sum", "alias": "fatturato" }
        ],
        "sortBy": { "field": "fatturato", "order": "desc" },
        "limit": 10
      },
      "chartConfig": {
        "chartType": "pie",
        "labelField": "prodotto",
        "valueField": "fatturato",
        "showLegend": true,
        "legendPosition": "right",
        "height": 300,
        "colors": ["#4CAF50", "#2196F3", "#FF9800", "#E91E63", "#9C27B0", "#00BCD4", "#795548", "#607D8B", "#3F51B5", "#009688"]
      },
      "title": "Products for Customer",
      "visible": true
    }
  ],

  "tools": {
    "aiAnalyzer": true,
    "export": false,
    "refresh": true,
    "fullscreen": false
  },

  "status": "active",
  "author": "system",
  "version": 1
}
